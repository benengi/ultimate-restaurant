<div class="row">
  <div class="col-md-6">
    <a routerLink="/" class="btn btn-link">
      <i class="fa fa-arrow-circle-o-left"></i>
      Regresar
    </a>

  </div>
  <div class="col-md-6">
    <div *ngIf="isAdmin" class="btn-group pull-right">
      <button (click)="onDeleteClick()" class="btn btn-danger">
        Borrar Orden
      </button>
    </div>
  </div>
</div>
<hr>
<div *ngIf="order" class="card">

  <h3 class="card-header">Orden: {{order.id}} </h3>
  <div class="card-body">
    <div class="row">
      <div class="cold-md-8 col-sm-6">
        <label>
          <img src="assets/user.svg" class="icon-sm">
          <b>Cliente:</b> {{order.customerName}}</label>
        <br>
        <label>
          <img src="assets/home.svg" class="icon-sm">
          <b>Direccion:</b> {{currentOrderEmail}}</label>
      </div>
      <div class="cold-md-8 col-sm-6">
        <h3 class="pull-right">
          Precio Total
          <span [class.text-danger]="hasBalance" [class.text-success]="!hasBalance">
            {{totalPrice | currency:'USD': 'symbol' | changeDecimal}}
          </span>
        </h3>
      </div>
    </div>

    <ul class="list-group">
      <li class="list-group-item">
        <div *ngIf="isAdmin" class="clearfix">
          <form (submit)="updateStatus()">
            <div class="input-group">
              <label class="mr-2">
                <img src="assets/list.svg" class="icon-sm">
                <b> Estado de Pedido: </b>
              </label>
              <select [value]="order.status" style="max-width: 40%" class="form-control" name="inventoryId" [(ngModel)]="order.status">
                <option *ngFor="let x of statusOptions" value={{x}}>{{x}} </option>
              </select>
              <span class="input-group-btn">
                <button type="submit" class="btn btn-primary">Actualizar</button>
              </span>
            </div>
          </form>
        </div>
        <div *ngIf="!isAdmin">
          <label>
            <img src="assets/list.svg" class="icon-sm">
            <b>Estado de Pedido:</b>
            <i *ngIf="order.status == 'Recibida' " class="fa fa-square-o"></i>
            <i *ngIf="order.status == 'Aprobado' " class="fa fa-check-square-o"></i>
            <i *ngIf="order.status == 'Rechazada' " class="fa fa-exclamation-triangle"></i>
            <i *ngIf="order.status == 'Lista' " class="fa fa-star"></i>
            <i *ngIf="order.status == 'Enviada' " class="fa fa-paper-plane"></i>
            {{order.status}}
          </label>
        </div>
      </li>

      <li class="list-group-item">
        <div class="clearfix">
          <form (submit)="updateStatus()">
            <div class="input-group">
              <label class="mr-2">
                <img src="assets/notepad.svg" class="icon-sm">
                <b>Nota / Instrucciones Especiales:</b>
              </label>
              <textarea class="form-control" name="note" rows="1" [(ngModel)]="order.note" style="max-width: 40%"></textarea>
              <span class="input-group-btn">
                <button type="submit" class="btn btn-primary">Actualizar</button>
              </span>
            </div>
          </form>
        </div>
      </li>
      <li class="list-group-item">
        <img src="assets/time.svg" class="icon-sm">
        <b>Hora Recibida:</b> {{order.timeReceived | date:'dd-MM-yyyy HH:mm a'}} |
        <b>Hora Enviada:</b> {{order.timeEnviada | date:'dd-MM-yyyy HH:mm a'}}</li>
    </ul>
    <hr>
    <h4>
      <img src="assets/cart.svg" class="icon"> Items
      <button *ngIf="isAdmin" class="btn btn-success btn-sm" (click)="openDialog()">
        <i class="fa fa-plus"></i> Adicionar Item </button>
    </h4>
    <div style="overflow:scroll; max-height:400px;">
      <table class="table table-striped table-hover" style='margin:auto; width:100%'>
        <thead>
          <tr>
            <th>Descripci√≥n</th>
            <th>Cantidad</th>
            <th>Precio por Unidad</th>
            <th>Precio Total</th>
            <th>Borrar</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let lineItem of order.lineItems; let i = index">
            <td>{{lineItem.description}}</td>
            <td>{{lineItem.quantity}}</td>
            <td>{{lineItem.pricePerUnit | currency:'USD': 'symbol' | changeDecimal }}</td>
            <td>{{lineItem.quantity * lineItem.pricePerUnit | currency:'USD': 'symbol' | changeDecimal }}</td>
            <td>
              <a class='text-center' (click)="deleteLineItem(i) " class="btn btn-secondary btn-sm">
                <i class="fa fa-trash"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>


  </div>
  <a *ngIf="isAdmin" (click)="submitOrder()" class="btn btn-md btn-warning">
    <i class="fa fa-plus"></i> Actualizar Order
  </a>
  <br>
  <br>

</div>

<div (click)="onContainerClicked($event)" class="modal fade" tabindex="-1" [ngStyle]="{'display': visible ? 'block' : 'none', 'opacity': visibleAnimate ? 1 : 0}">
  <div class="modal-dialog modal-lg" style="overflow:scroll;">
    <div class="modal-content" style="overflow:scroll;">
      <br>
      <div class="modal-header" style="overflow:scroll;">

        <h3>Adicionar {{selectedListTitle}}</h3>
      </div>
      <div class="modal-body" style="overflow:scroll;">

        <div style="overflow:scroll;" *ngIf="!selectionIsVisible && !completoIsVisible ">
          <button class="btn btn-primary btn-lg" (click)="showSelection('seco')">
            <img src="assets/seco.svg" class="icon"> Seco </button>
          <button class="btn btn-primary btn-lg" (click)="showSelection('sopa')">
            <img src="assets/sopa.svg" class="icon"> Sopa </button>
          <button class="btn btn-primary btn-lg" (click)="showSelection('bebiba')">
            <img src="assets/juice.svg" class="icon"> Bebiba </button>
          <button class="btn btn-primary btn-lg" (click)="showCompleto()">
            <img src="assets/completo.svg" class="icon"> Completo </button>
        </div>

        <div *ngIf="selectionIsVisible">

          <div class="form-group row">
            <label for="staticEmail" class="col-sm-2 col-form-label">Cantidad</label>
            <div class="col-sm-10">
              <select [value]=1 class="form-control" name="quantity" [(ngModel)]="newLineItem.quantity">
                <option *ngFor="let x of quantityOptions" value={{x}}>{{x}} </option>
              </select>
            </div>
          </div>

          <select [value]="undefined" class="form-control" name="inventoryId" [(ngModel)]="newLineItem.inventoryId">
            <option *ngFor="let x of selectedList" value={{x.id}}>{{x.description}} ({{x.price | currency:'USD': 'symbol' | changeDecimal }})</option>
          </select>
          <br>

          <h4>Total: {{newLineItem.quantity * getNewLineItemPrice() | currency:'USD': 'symbol' | changeDecimal }}</h4>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" (click)="hide()">Cancelar</button>
            <button type="button" class="btn btn-success" (click)="addNewItem()">
              <i class="fa fa-plus"></i> Agregar Nuevo Item</button>
          </div>
        </div>

        <div *ngIf="completoIsVisible">
          <form>

            <div class="form-group row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Cantidad</label>
              <div class="col-sm-10">
                <select [value]=1 class="form-control" name="quantity" [(ngModel)]="newCompletoItem.quantity">
                  <option *ngFor="let x of quantityOptions" value={{x}}>{{x}} </option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Seco</label>
              <div class="col-sm-10">
                <select [value]="undefined" class="form-control" name="inventoryId" [(ngModel)]="newCompletoItem.seco">
                  <option *ngFor="let x of secoItems" value={{x.description}}>{{x.description}} </option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Sopa</label>
              <div class="col-sm-10">
                <select [value]="undefined" class="form-control" name="inventoryId" [(ngModel)]="newCompletoItem.sopa">
                  <option *ngFor="let x of sopaItems" value={{x.description}}>{{x.description}} </option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Bebiba</label>
              <div class="col-sm-10">
                <select [value]="undefined" class="form-control" name="inventoryId" [(ngModel)]="newCompletoItem.bebiba">
                  <option *ngFor="let x of bebibaItems" value={{x.description}}>{{x.description}}</option>
                </select>
              </div>
            </div>
          </form>
          <h4>Total: {{newCompletoItem.quantity * getNewCompletoPrice() | currency:'USD': 'symbol' | changeDecimal }}</h4>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" (click)="hide()">Cancelar</button>
            <button type="button" class="btn btn-success" (click)="addNewCompleto()">
              <i class="fa fa-plus"></i>Agregar Nuevo Item</button>
          </div>
        </div>

      </div>

    </div>
  </div>
</div>